function res = PGA_prod(l, r, varargin)
% basis vector = ["1", "e0", "e1", "e2", "e3", "e01", "e02", "e03", "e23", "e31", "e12", "e123", "e023", "e031", "e012", "e0123"]
res = [l(1)*r(1) + l(3)*r(3)  + l(4)*r(4)  + l(5)*r(5)  - l(9)*r(9)  - l(10)*r(10) - l(11)*r(11) - l(12)*r(12); % 1
      l(1)*r(2)  + l(2)*r(1)  - l(3)*r(6)  - l(4)*r(7)  - l(5)*r(8)  + l(6)*r(3)   + l(7)*r(4)   + l(8)*r(5) - l(9)*r(13) - l(10)*r(14) - l(11)*r(15) + l(12)*r(16) - l(13)*r(9) - l(14)*r(10) - l(15)*r(11) - l(16)*r(12); % e0
      l(1)*r(3)  + l(3)*r(1)  - l(4)*r(11) + l(5)*r(10) - l(9)*r(12) - l(10)*r(5)  + l(11)*r(4)  - l(12)*r(9); % e1
      l(1)*r(4)  + l(3)*r(11) + l(4)*r(1)  - l(5)*r(9)  + l(9)*r(5)  - l(10)*r(12) - l(11)*r(3)  - l(12)*r(10); % e2
      l(1)*r(5)  - l(3)*r(10) + l(4)*r(9)  + l(5)*r(1)  - l(9)*r(4)  + l(10)*r(3)  - l(11)*r(12) - l(12)*r(11); % e3
      l(1)*r(6)  + l(2)*r(3)  - l(3)*r(2)  + l(4)*r(15) - l(5)*r(14) + l(6)*r(1)   - l(7)*r(11)  + l(8)*r(10) - l(9)*r(16) - l(10)*r(8) + l(11)*r(7) + l(12)*r(13) - l(13)*r(12) - l(14)*r(5) + l(15)*r(4) - l(16)*r(9); % e01
      l(1)*r(7)  + l(2)*r(4)  - l(3)*r(15) - l(4)*r(2)  + l(5)*r(13) + l(6)*r(11)  + l(7)*r(1)   - l(8)*r(9) + l(9)*r(8) - l(10)*r(16) - l(11)*r(6) + l(12)*r(14) + l(13)*r(5) - l(14)*r(12) - l(15)*r(3) - l(16)*r(10); % e02
      l(1)*r(8)  + l(2)*r(5)  + l(3)*r(14) - l(4)*r(13) - l(5)*r(2)  - l(6)*r(10)  + l(7)*r(9)   + l(8)*r(1) - l(9)*r(7) + l(10)*r(6) - l(11)*r(16) + l(12)*r(15) - l(13)*r(4) + l(14)*r(3) - l(15)*r(12) - l(16)*r(11); % e03
      l(1)*r(9)  + l(3)*r(12) + l(4)*r(5)  - l(5)*r(4)  + l(9)*r(1)  - l(10)*r(11) + l(11)*r(10) + l(12)*r(3); % e23
      l(1)*r(10) - l(3)*r(5)  + l(4)*r(12) + l(5)*r(3)  + l(9)*r(11) + l(10)*r(1)  - l(11)*r(9)  + l(12)*r(4); % e31
      l(1)*r(11) + l(3)*r(4)  - l(4)*r(3)  + l(5)*r(12) - l(9)*r(10) + l(10)*r(9)  + l(11)*r(1)  + l(12)*r(5); % e12
      l(1)*r(12) + l(3)*r(9)  + l(4)*r(10) + l(5)*r(11) + l(9)*r(3)  + l(10)*r(4)  + l(11)*r(5)  + l(12)*r(1); % e123
      l(1)*r(13) + l(2)*r(9)  - l(3)*r(16) - l(4)*r(8)  + l(5)*r(7)  + l(6)*r(12)  + l(7)*r(5)   - l(8)*r(4) + l(9)*r(2) - l(10)*r(15) + l(11)*r(14) - l(12)*r(6) + l(13)*r(1) - l(14)*r(11) + l(15)*r(10) + l(16)*r(3); % e023
      l(1)*r(14) + l(2)*r(10) + l(3)*r(8)  - l(4)*r(16) - l(5)*r(6)  - l(6)*r(5)   + l(7)*r(12)  + l(8)*r(3) + l(9)*r(15) + l(10)*r(2) - l(11)*r(13) - l(12)*r(7) + l(13)*r(11) + l(14)*r(1) - l(15)*r(9) + l(16)*r(4); % e031
      l(1)*r(15) + l(2)*r(11) - l(3)*r(7)  + l(4)*r(6)  - l(5)*r(16) + l(6)*r(4)   - l(7)*r(3)   + l(8)*r(12) - l(9)*r(14) + l(10)*r(13) + l(11)*r(2) - l(12)*r(8) - l(13)*r(10) + l(14)*r(9) + l(15)*r(1) + l(16)*r(5); % e012
      l(1)*r(16) + l(2)*r(12) - l(3)*r(13) - l(4)*r(14) - l(5)*r(15) + l(6)*r(9)   + l(7)*r(10)  + l(8)*r(11) + l(9)*r(6) + l(10)*r(7) + l(11)*r(8) - l(12)*r(2) + l(13)*r(3) + l(14)*r(4) + l(15)*r(5) + l(16)*r(1)]; % e0123

if ~isempty(varargin)
    res = PGA_prod(res, varargin{1}, varargin{2:end});
end

end