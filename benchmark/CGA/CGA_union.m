function X = CGA_union(type, x)
% 求解多个点并(vee)的几何元素
% 输入的CGA点及输出的几何特征均已单位化 Point
% type 10 Sphere ["ei", "eo", "e1", "e2", "e3"]
% type 11 Plane ["ei", "eo", "e1", "e2", "e3"]
% type 20 Circle ["eio", "ei1", "ei2", "ei3", "eo1", "eo2", "eo3", "e23", "e31", "e12"]
% type 21 Line ["eio", "ei1", "ei2", "ei3", "eo1", "eo2", "eo3", "e23", "e31", "e12"]
% type 30 Ponit pair ["eio1", "eio2", "eio3", "ei23", "ei31", "ei12", "eo23", "eo31", "eo12", "e123"]
% type 31 Flat point ["eio1", "eio2", "eio3", "ei23", "ei31", "ei12", "eo23", "eo31", "eo12", "e123"]

switch type
    case 10
        X = [x(5,4)*(x(4,3)*(x(1,1)*x(3,2) - x(1,2)*x(3,1)) - x(3,3)*(x(1,1)*x(4,2) - x(1,2)*x(4,1)) + x(1,3)*(x(3,1)*x(4,2) - x(3,2)*x(4,1))) - x(4,4)*(x(5,3)*(x(1,1)*x(3,2) - x(1,2)*x(3,1)) - x(3,3)*(x(1,1)*x(5,2) - x(1,2)*x(5,1)) + x(1,3)*(x(3,1)*x(5,2) - x(3,2)*x(5,1))) + x(3,4)*(x(5,3)*(x(1,1)*x(4,2) - x(1,2)*x(4,1)) - x(4,3)*(x(1,1)*x(5,2) - x(1,2)*x(5,1)) + x(1,3)*(x(4,1)*x(5,2) - x(4,2)*x(5,1))) - x(1,4)*(x(5,3)*(x(3,1)*x(4,2) - x(3,2)*x(4,1)) - x(4,3)*(x(3,1)*x(5,2) - x(3,2)*x(5,1)) + x(3,3)*(x(4,1)*x(5,2) - x(4,2)*x(5,1)));
            x(5,3)*(x(3,1)*x(4,2) - x(3,2)*x(4,1)) - x(4,3)*(x(3,1)*x(5,2) - x(3,2)*x(5,1)) + x(3,3)*(x(4,1)*x(5,2) - x(4,2)*x(5,1)) - x(5,4)*(x(3,1)*x(4,2) - x(3,2)*x(4,1) - x(4,3)*(x(3,1) - x(3,2)) + x(3,3)*(x(4,1) - x(4,2))) + x(4,4)*(x(3,1)*x(5,2) - x(3,2)*x(5,1) - x(5,3)*(x(3,1) - x(3,2)) + x(3,3)*(x(5,1) - x(5,2))) - x(3,4)*(x(4,1)*x(5,2) - x(4,2)*x(5,1) - x(5,3)*(x(4,1) - x(4,2)) + x(4,3)*(x(5,1) - x(5,2)));
            x(5,3)*(x(1,1)*x(4,2) - x(1,2)*x(4,1)) - x(4,3)*(x(1,1)*x(5,2) - x(1,2)*x(5,1)) + x(1,3)*(x(4,1)*x(5,2) - x(4,2)*x(5,1)) - x(5,4)*(x(1,1)*x(4,2) - x(1,2)*x(4,1) - x(4,3)*(x(1,1) - x(1,2)) + x(1,3)*(x(4,1) - x(4,2))) + x(4,4)*(x(1,1)*x(5,2) - x(1,2)*x(5,1) - x(5,3)*(x(1,1) - x(1,2)) + x(1,3)*(x(5,1) - x(5,2))) - x(1,4)*(x(4,1)*x(5,2) - x(4,2)*x(5,1) - x(5,3)*(x(4,1) - x(4,2)) + x(4,3)*(x(5,1) - x(5,2)));
            x(3,3)*(x(1,1)*x(5,2) - x(1,2)*x(5,1)) - x(5,3)*(x(1,1)*x(3,2) - x(1,2)*x(3,1)) - x(1,3)*(x(3,1)*x(5,2) - x(3,2)*x(5,1)) + x(5,4)*(x(1,1)*x(3,2) - x(1,2)*x(3,1) - x(3,3)*(x(1,1) - x(1,2)) + x(1,3)*(x(3,1) - x(3,2))) - x(3,4)*(x(1,1)*x(5,2) - x(1,2)*x(5,1) - x(5,3)*(x(1,1) - x(1,2)) + x(1,3)*(x(5,1) - x(5,2))) + x(1,4)*(x(3,1)*x(5,2) - x(3,2)*x(5,1) - x(5,3)*(x(3,1) - x(3,2)) + x(3,3)*(x(5,1) - x(5,2)));
            x(4,3)*(x(1,1)*x(3,2) - x(1,2)*x(3,1)) - x(3,3)*(x(1,1)*x(4,2) - x(1,2)*x(4,1)) + x(1,3)*(x(3,1)*x(4,2) - x(3,2)*x(4,1)) - x(4,4)*(x(1,1)*x(3,2) - x(1,2)*x(3,1) - x(3,3)*(x(1,1) - x(1,2)) + x(1,3)*(x(3,1) - x(3,2))) + x(3,4)*(x(1,1)*x(4,2) - x(1,2)*x(4,1) - x(4,3)*(x(1,1) - x(1,2)) + x(1,3)*(x(4,1) - x(4,2))) - x(1,4)*(x(3,1)*x(4,2) - x(3,2)*x(4,1) - x(4,3)*(x(3,1) - x(3,2)) + x(3,3)*(x(4,1) - x(4,2)))];
    case 11
        X = [x(4,3)*(x(3,1)*x(5,2) - x(3,2)*x(5,1)) - x(5,3)*(x(3,1)*x(4,2) - x(3,2)*x(4,1)) - x(3,3)*(x(4,1)*x(5,2) - x(4,2)*x(5,1));
            0;
            x(4,2)*x(5,1) - x(4,1)*x(5,2) + x(5,3)*(x(4,1) - x(4,2)) - x(4,3)*(x(5,1) - x(5,2));
            x(3,1)*x(5,2) - x(3,2)*x(5,1) - x(5,3)*(x(3,1) - x(3,2)) + x(3,3)*(x(5,1) - x(5,2));
            x(3,2)*x(4,1) - x(3,1)*x(4,2) + x(4,3)*(x(3,1) - x(3,2)) - x(3,3)*(x(4,1) - x(4,2))];
    case 20
        X = [x(5,3)*(x(3,1)*x(4,2) - x(3,2)*x(4,1)) - x(4,3)*(x(3,1)*x(5,2) - x(3,2)*x(5,1)) + x(3,3)*(x(4,1)*x(5,2) - x(4,2)*x(5,1));
            x(5,3)*(x(1,1)*x(4,2) - x(1,2)*x(4,1)) - x(4,3)*(x(1,1)*x(5,2) - x(1,2)*x(5,1)) + x(1,3)*(x(4,1)*x(5,2) - x(4,2)*x(5,1));
            x(3,3)*(x(1,1)*x(5,2) - x(1,2)*x(5,1)) - x(5,3)*(x(1,1)*x(3,2) - x(1,2)*x(3,1)) - x(1,3)*(x(3,1)*x(5,2) - x(3,2)*x(5,1));
            x(4,3)*(x(1,1)*x(3,2) - x(1,2)*x(3,1)) - x(3,3)*(x(1,1)*x(4,2) - x(1,2)*x(4,1)) + x(1,3)*(x(3,1)*x(4,2) - x(3,2)*x(4,1));
            x(4,2)*x(5,1) - x(4,1)*x(5,2) + x(5,3)*(x(4,1) - x(4,2)) - x(4,3)*(x(5,1) - x(5,2));
            x(3,1)*x(5,2) - x(3,2)*x(5,1) - x(5,3)*(x(3,1) - x(3,2)) + x(3,3)*(x(5,1) - x(5,2));
            x(3,2)*x(4,1) - x(3,1)*x(4,2) + x(4,3)*(x(3,1) - x(3,2)) - x(3,3)*(x(4,1) - x(4,2));
            x(1,1)*x(3,2) - x(1,2)*x(3,1) - x(3,3)*(x(1,1) - x(1,2)) + x(1,3)*(x(3,1) - x(3,2));
            x(1,1)*x(4,2) - x(1,2)*x(4,1) - x(4,3)*(x(1,1) - x(1,2)) + x(1,3)*(x(4,1) - x(4,2));
            x(1,1)*x(5,2) - x(1,2)*x(5,1) - x(5,3)*(x(1,1) - x(1,2)) + x(1,3)*(x(5,1) - x(5,2))];
    case 21
        X = [0;
            x(4,1)*x(5,2) - x(4,2)*x(5,1);
            x(3,2)*x(5,1) - x(3,1)*x(5,2);
            x(3,1)*x(4,2) - x(3,2)*x(4,1);
            0;
            0;
            0;
            x(3,1) - x(3,2);
            x(4,1) - x(4,2);
            x(5,1) - x(5,2)];
    case 30
        X = [x(4,1)*x(5,2) - x(4,2)*x(5,1);
            x(3,2)*x(5,1) - x(3,1)*x(5,2);
            x(3,1)*x(4,2) - x(3,2)*x(4,1);
            x(1,2)*x(3,1) - x(1,1)*x(3,2);
            x(1,2)*x(4,1) - x(1,1)*x(4,2);
            x(1,2)*x(5,1) - x(1,1)*x(5,2);
            x(3,2) - x(3,1);
            x(4,2) - x(4,1);
            x(5,2) - x(5,1);
            x(1,2) - x(1,1)];
    case 31
        X = [0;
            0;
            0;
            x(3,1);
            x(4,1);
            x(5,1);
            0;
            0;
            0;
            1];
end
end